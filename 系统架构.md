系统架构设计
1. 整体架构图
text
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   微信小程序    │────│   云函数后端     │────│   云数据库      │
│   (前端)        │    │   (BaaS)        │    │   (数据层)      │
└─────────────────┘    └──────────────────┘    └─────────────────┘
         │                        │                        │
         │                        │                        │
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│ 微信客服消息    │    │   对象存储       │    │   缓存服务      │
│ (沟通通道)      │    │ (图片/文件)     │    │ (状态缓存)      │
└─────────────────┘    └──────────────────┘    └─────────────────┘
2. 技术栈选择（AI编程友好）
前端技术栈

yaml
框架: 微信小程序原生框架
  - 理由: 文档完善，AI训练数据丰富
  - AI提示词: "用微信小程序原生框架实现..."
  
UI组件: Vant Weapp
  - 理由: 组件丰富，社区活跃
  - AI适配: 有大量训练样本
后端技术栈

yaml
平台: 微信云开发
  - 包含: 云函数 + 云数据库 + 云存储
  - AI优势: 配置简单，减少运维复杂度
  
语言: Node.js
  - 理由: AI代码生成质量高，生态丰富
3. API 设计规范
RESTful 风格接口

javascript
// 订单相关接口
GET    /api/orders          # 获取订单列表
POST   /api/orders          # 创建新订单  
PUT    /api/orders/:id      # 更新订单状态
GET    /api/orders/:id      # 获取订单详情

// 陪诊师接口
GET    /api/companions      # 获取陪诊师列表
GET    /api/companions/:id  # 获取陪诊师详情
PUT    /api/companions/:id  # 更新陪诊师资料
4. AI编程适配建议
4.1 模块化开发提示词
text
当使用AI编程时，按以下结构提供需求：

【模块名称】：订单管理模块
【功能描述】：实现订单状态流转和跟踪
【输入参数】：order_id, new_status, evidence_image
【预期输出】：更新后的订单信息
【错误处理】：状态冲突、参数验证失败
4.2 代码生成模板
javascript
// AI代码生成模板 - 云函数示例
exports.main = async (event) => {
  try {
    // 1. 参数验证
    const { order_id, new_status } = event;
    if (!order_id || !new_status) {
      throw new Error('缺少必要参数');
    }
    
    // 2. 业务逻辑
    const db = cloud.database();
    const result = await db.collection('orders').doc(order_id).update({
      data: { status: new_status, updated_at: new Date() }
    });
    
    // 3. 返回结果
    return { code: 200, data: result, message: '更新成功' };
    
  } catch (error) {
    // 4. 错误处理
    return { code: 500, message: error.message };
  }
};
5. 部署与监控
环境配置

yaml
开发环境: 
  - 数据库: 测试数据库
  - 功能: 完整调试模式
  
生产环境:
  - 数据库: 生产数据库  
  - 功能: 性能优化版本
关键监控指标

订单创建成功率

消息响应时间

用户完成率

纠纷发生率

