<!--pages/companion-list/companion-list.wxml-->
<view class="companion-list-container">
  <!-- æœç´¢æ  -->
  <view class="search-section">
    <view class="search-bar">
      <input
        class="search-input"
        placeholder="æœç´¢é™ªè¯Šå¸ˆå§“åæˆ–æœåŠ¡èŒƒå›´"
        value="{{keyword}}"
        bindinput="onSearchInput"
        bindconfirm="onSearchSubmit"
      />
      <view class="search-icon">ğŸ”</view>
    </view>
    <view class="filter-btn" bindtap="onFilterTap">
      <text>ç­›é€‰</text>
    </view>
  </view>

  <!-- ç­›é€‰æ ‡ç­¾ -->
  <view class="filter-tags" wx:if="{{hospitalName}}">
    <view class="filter-tag">
      <text>{{hospitalName}}</text>
      <text class="tag-close" bindtap="clearHospitalFilter">Ã—</text>
    </view>
  </view>

  <!-- é™ªè¯Šå¸ˆåˆ—è¡¨ -->
  <view class="companion-list" wx:if="{{companionList.length > 0}}">
    <view
      class="companion-item"
      wx:for="{{companionList}}"
      wx:key="_id"
      bindtap="onCompanionTap"
      data-id="{{item._id}}"
    >
      <view class="companion-avatar-wrapper">
        <image class="companion-avatar" src="{{item.avatar}}" mode="aspectFill" lazy-load="{{true}}" />
        <view class="companion-certified" wx:if="{{item.certification && item.certification.certified}}">
          âœ“
        </view>
      </view>
      
      <view class="companion-info">
        <view class="companion-header">
          <view class="companion-name">{{item.name}}</view>
          <view class="companion-rating">
            <text class="rating-star">â­</text>
            <text class="rating-score">{{item.ratingText}}</text>
            <text class="rating-count">({{item.reviewCount || 0}}è¯„ä»·)</text>
          </view>
        </view>

        <view class="companion-stats">
          <text class="stat-item">æ¥å•æ•°ï¼š{{item.orderCount || 0}}å•</text>
          <text class="stat-divider">Â·</text>
          <text class="stat-item" wx:if="{{item.distance}}">è·ç¦»ï¼š{{item.distance}}ç±³</text>
        </view>

        <view class="companion-scope">
          <text class="scope-label">æœåŠ¡èŒƒå›´ï¼š</text>
          <text class="scope-text">{{item.serviceScopeText}}</text>
        </view>

        <view class="companion-tags" wx:if="{{item.tags && item.tags.length > 0}}">
          <text class="tag" wx:for="{{item.tags}}" wx:key="index" wx:for-item="tag">
            {{tag}}
          </text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <empty-state
    wx:if="{{!loading && companionList.length === 0}}"
    icon="ğŸ‘¨â€âš•ï¸"
    title="{{keyword ? 'æœªæ‰¾åˆ°ç›¸å…³é™ªè¯Šå¸ˆ' : 'æš‚æ— é™ªè¯Šå¸ˆ'}}"
    description="{{keyword ? 'è¯•è¯•å…¶ä»–å…³é”®è¯å§' : 'æ•¬è¯·æœŸå¾…'}}"
    buttonText="{{keyword ? '' : ''}}"
  />

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-wrapper" wx:if="{{loading && companionList.length > 0}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- æ²¡æœ‰æ›´å¤šæ•°æ® -->
  <view class="no-more" wx:if="{{!hasMore && companionList.length > 0}}">
    <text>æ²¡æœ‰æ›´å¤šæ•°æ®äº†</text>
  </view>
</view>

