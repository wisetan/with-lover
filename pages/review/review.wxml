<!--pages/review/review.wxml-->
<view class="review-container">
  <!-- 订单信息 -->
  <view class="order-info card" wx:if="{{order}}">
    <view class="info-item">
      <text class="info-label">陪诊师：</text>
      <text class="info-value">{{order.companion ? order.companion.name : '未知'}}</text>
    </view>
    <view class="info-item">
      <text class="info-label">服务医院：</text>
      <text class="info-value">{{order.hospital}}</text>
    </view>
    <view class="info-item">
      <text class="info-label">服务科室：</text>
      <text class="info-value">{{order.department}}</text>
    </view>
  </view>

  <!-- 评分 -->
  <view class="rating-section card">
    <view class="section-title">服务评分</view>
    <view class="rating-stars">
      <view
        class="star {{rating >= index ? 'star--active' : ''}}"
        wx:for="{{[1,2,3,4,5]}}"
        wx:key="index"
        wx:for-item="star"
        data-rating="{{star}}"
        bindtap="onRatingChange"
      >
        ⭐
      </view>
    </view>
    <view class="rating-text">{{rating === 5 ? '非常满意' : rating === 4 ? '满意' : rating === 3 ? '一般' : rating === 2 ? '不满意' : '非常不满意'}}</view>
  </view>

  <!-- 评价标签 -->
  <view class="tags-section card">
    <view class="section-title">评价标签（最多3个）</view>
    <view class="tags-list">
      <view
        class="tag {{selectedTags.includes(item) ? 'tag--active' : ''}}"
        wx:for="{{tags}}"
        wx:key="index"
        wx:for-item="item"
        data-tag="{{item}}"
        bindtap="toggleTag"
      >
        {{item}}
      </view>
    </view>
  </view>

  <!-- 评价内容 -->
  <view class="comment-section card">
    <view class="section-title">评价内容</view>
    <textarea
      class="comment-input"
      placeholder="请描述您的服务体验（选填）"
      value="{{comment}}"
      bindinput="onCommentInput"
      maxlength="500"
    />
    <view class="char-count">{{comment.length}}/500</view>
  </view>

  <!-- 提交按钮 -->
  <view class="fixed-bottom">
    <base-button
      type="primary"
      size="large"
      text="提交评价"
      block="{{true}}"
      state="{{loading ? 'loading' : 'normal'}}"
      bindtap="submitReview"
    />
  </view>
</view>


